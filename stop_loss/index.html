<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamma Distribution Integral with Comparison</title>
</head>
<body>

    <h2>Gamma Distribution Integral Calculator</h2>

    <!-- Input fields for alpha and lambda parameters -->
    <label for="alpha">Alpha (shape parameter):</label>
    <input type="number" id="alpha" step="0.01"><br><br>

    <label for="lambda">Lambda (rate parameter):</label>
    <input type="number" id="lambda" step="0.01"><br><br>

    <!-- Input fields for the integration limits -->
    <label for="lowerLimit">Lower Limit:</label>
    <input type="number" id="lowerLimit" step="0.01"><br><br>

    <label for="upperLimit">Upper Limit:</label>
    <input type="number" id="upperLimit" step="0.01"><br><br>

    <!-- Button to calculate the integral -->
    <button onclick="calculateIntegral()">Calculate Integral</button><br><br>
    <p id="exactResult">Integral Result (Exact Factorial): </p>
    <p id="stirlingResult">Integral Result (Stirling Approximation): </p>

    <script>
        // Gamma density function using exact factorial
        function gammaDensityExact(x, alpha, lambda) {
            if (x < 0) return 0; // Gamma density is zero for x < 0
            const gamma = factorial(alpha - 1);
            return (Math.pow(x, alpha - 1) * Math.exp(-x / lambda)) /
                   (Math.pow(lambda, alpha) * gamma);
        }

        // Gamma density function using Stirling's approximation
        function gammaDensityStirling(x, alpha, lambda) {
            if (x < 0) return 0; // Gamma density is zero for x < 0
            const gamma = stirlingApproximation(alpha - 1);
            return (Math.pow(x, alpha - 1) * Math.exp(-x / lambda)) /
                   (Math.pow(lambda, alpha) * gamma);
        }

        // Numerical integration using the trapezoidal rule
        function integrate(f, lower, upper, step, alpha, lambda) {
            let total = 0;
            for (let x = lower; x <= upper; x += step) {
                const nextX = Math.min(x + step, upper);
                total += ((f(x, alpha, lambda) + f(nextX, alpha, lambda)) / 2) * (nextX - x);
            }
            return total;
        }

        // Exact factorial calculation
        function factorial(n) {
            if (n <= 1) return 1;
            return n * factorial(n - 1);
        }

        // Stirling's approximation for factorial
        function stirlingApproximation(n) {
            if (n <= 1) return 1;
            return Math.sqrt(2 * Math.PI * n) * Math.pow(n / Math.E, n);
        }

        // Main function to calculate and compare integrals
        function calculateIntegral() {
            const alpha = parseFloat(document.getElementById('alpha').value);
            const lambda = parseFloat(document.getElementById('lambda').value);
            const lowerLimit = parseFloat(document.getElementById('lowerLimit').value);
            const upperLimit = parseFloat(document.getElementById('upperLimit').value);

            if (alpha <= 0 || lambda <= 0) {
                document.getElementById('exactResult').innerText = "Alpha and Lambda must be greater than zero.";
                document.getElementById('stirlingResult').innerText = "Alpha and Lambda must be greater than zero.";
                return;
            }

            if (lowerLimit >= upperLimit) {
                document.getElementById('exactResult').innerText = "Lower limit must be less than upper limit.";
                document.getElementById('stirlingResult').innerText = "Lower limit must be less than upper limit.";
                return;
            }

            // Perform numerical integration with both methods
            const stepSize = 0.001; // Smaller step size for higher accuracy
            const integralExact = integrate(gammaDensityExact, lowerLimit, upperLimit, stepSize, alpha, lambda);
            const integralStirling = integrate(gammaDensityStirling, lowerLimit, upperLimit, stepSize, alpha, lambda);

            document.getElementById('exactResult').innerText = `Integral Result (Exact Factorial): ${integralExact}`;
            document.getElementById('stirlingResult').innerText = `Integral Result (Stirling Approximation): ${integralStirling}`;
        }
    </script>

</body>
</html>
